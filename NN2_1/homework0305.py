# Written by Dong Shen (shdon)

import numpy as np

def ReadData():
    X = np.array([0, 1]).reshape(1, 2)
    Y = np.array([1, 0]).reshape(1, 2)
    return X, Y

def ForwardCalculation(w, b, x):
    return np.dot(w, x) + b

def BackPropagation(x, y, z):
    dz = z - y
    db = dz
    dw = np.dot(dz, x)
    return dw, db

def UpdateWeights(w, b, dw, db, eta):
    w = w - eta * dw
    b = b - eta * db
    return w, b

def GetSample(X, Y, i):
    i = i % 2
    x = X[0, i]
    y = Y[0, i]
    return x, y

def Test(w,b):
    z1 = ForwardCalculation(w, b, 0)
    z2 = ForwardCalculation(w, b, 1)
    print (z1,z2)
    if np.abs(z1-1) < 0.001 and np.abs(z2-0)<0.001:
        return True
    return False

if __name__ == '__main__':
    X, Y = ReadData()

    iter = 100
    eta = 0.1
    w, b = 0, 0
    n = 0
    print("Round 0:")
    while(Test(w,b) == False):
        for i in range(2):
            x, y = GetSample(X, Y, i)
            z = ForwardCalculation(w, b, x)
            dw, db = BackPropagation(x, y, z)
            w, b = UpdateWeights(w, b, dw, db, eta)
        n = n + 1
        print("Round %d:" %n)

    print("w = %f, b = %f" %(w, b))

"""
Result:

Round 0:
0 0
Round 1:
0.09 0.07999999999999999
Round 2:
0.1639 0.13679999999999998
Round 3:
0.225469 0.17632799999999998
Round 4:
0.27754398999999996 0.20302487999999996
Round 5:
0.32226254289999995 0.22021638479999994
Round 6:
0.361237275559 0.230392104408
Round 7:
0.39568671031789 0.23541470148168
Round 8:
0.4265334362411119 0.2366768243599128
Round 9:
0.45447774454342055 0.2352187845886413
Round 10:
0.48005286907564854 0.23181680810743935
Round 11:
0.5036664300480962 0.22704921695989955
Round 12:
0.5256315296477776 0.22134605916407196
Round 13:
0.5461900860630704 0.21502632495943536
Round 14:
0.5655303458214506 0.20832585308250268
Round 15:
0.5838000293892698 0.20141825480028613
Round 16:
0.6011162012642068 0.1944306014890873
Round 17:
0.6175726830015195 0.18745518509013326
Round 18:
0.6332456230223694 0.18055833343198507
Round 19:
0.6481976836071577 0.1737870169037985
Round 20:
0.6624811903921336 0.16717379883446615
Round 21:
0.6761405033733949 0.16074054383620218
Round 22:
0.6892138036861691 0.15450119479909008
Round 23:
0.701734441874505 0.14846385154437858
Round 24:
0.7137319569513617 0.14263232588554253
Round 25:
0.7252328482371849 0.1370073041523251
Round 26:
0.7362611614806057 0.1315872154628852
Round 27:
0.7468389354010626 0.1263688794518596
Round 28:
0.7569865432697811 0.12134798872940278
Round 29:
0.7667229555025605 0.11651946752193976
Round 30:
0.7760659427551362 0.11187773757734698
Round 31:
0.7850322341494392 0.10741691464146674
Round 32:
0.793637641611843 0.10313095298121822
Round 33:
0.8018971585686553 0.09901375105602706
Round 34:
0.8098250391918735 0.09505922815932921
Round 35:
0.817434862848672 0.09126137939211343
Round 36:
0.8247395872530802 0.08761431448579704
Round 37:
0.8317515929517232 0.08411228460839115
Round 38:
0.838482721125229 0.08074970025057515
Round 39:
0.8449443061989009 0.07752114251044184
Round 40:
0.8511472043899557 0.0744213695124415
Round 41:
0.8571018190436155 0.07144531925875663
Round 42:
0.8628181234038145 0.06858810988351616
Round 43:
0.8683056813091196 0.06584503803450781
Round 44:
0.873573666187848 0.06321157592287674
Round 45:
0.8786308786386541 0.06068336744327363
Round 46:
0.8834857628168478 0.05825622366352645
Round 47:
0.8881464217969788 0.055926117905473305
Round 48:
0.8926206320447034 0.053689180580620444
Round 49:
0.8969158571026181 0.051541693900920116
Round 50:
0.9010392605732904 0.04948008655252656
Round 51:
0.9049977184664417 0.04750092839615805
Round 52:
0.9087978309648461 0.04560092523961101
Round 53:
0.9124459336540489 0.04377691371450121
Round 54:
0.9159481082537344 0.04202585627927702
Round 55:
0.9193101928829706 0.040344836363122805
Round 56:
0.9225377918871909 0.038731053659860515
Round 57:
0.9256362852513577 0.03718181957691313
Round 58:
0.9286108376210441 0.03569455284142187
Round 59:
0.9314664069510079 0.0342667752634539
Round 60:
0.9342077527990718 0.03289610765468243
Round 61:
0.9368394442816871 0.031580265899820215
Round 62:
0.9393658677063532 0.03031705717732125
Round 63:
0.9417912338950493 0.02910437632534868
Round 64:
0.94411958521196 0.027940202348675114
Round 65:
0.9463548023080162 0.026822595061983368
Round 66:
0.9485006105940964 0.025749691864945468
Round 67:
0.9505605864541332 0.02471970464442874
Round 68:
0.9525381632088183 0.023730916799212354
Round 69:
0.9544366368401035 0.022781680382664482
Round 70:
0.9562591714862277 0.02187041335892337
Round 71:
0.9580088047165749 0.020995596968240493
Round 72:
0.9596884525952591 0.02015577319726647
Round 73:
0.9613009145419592 0.019349542350192483
Round 74:
0.9628488779981637 0.018575560716797224
Round 75:
0.9643349229066491 0.01783253833358467
Round 76:
0.9657615260116923 0.017119236834335805
Round 77:
0.9671310649872064 0.016434467386533202
Round 78:
0.9684458223997046 0.015777088710250187
Round 79:
0.9697079895127062 0.015146005176223887
Round 80:
0.9709196699389403 0.014540164979962689
Round 81:
0.9720828831464394 0.013958558388854958
Round 82:
0.9731995678243744 0.013400216059368919
Round 83:
0.9742715851142438 0.012864207421545149
Round 84:
0.9753007217118074 0.012349639128096612
Round 85:
0.976288692844935 0.011855653565532642
Round 86:
0.9772371451323376 0.01138142742483128
Round 87:
0.9781476593279441 0.010926170329278007
Round 88:
0.9790217529555014 0.010489123517186894
Round 89:
0.9798608828377876 0.010069558577309401
Round 90:
0.9806664475246558 0.009666776234824592
Round 91:
0.9814397896239544 0.009280105185887288
Round 92:
0.9821821980392097 0.008908900978793377
Round 93:
0.9828949101178015 0.008552544939897988
Round 94:
0.9835791137132096 0.008210443142494306
Round 95:
0.9842359491647714 0.00788202541693872
Round 96:
0.9848665111982481 0.007566744400369196
Round 97:
0.9854718507503688 0.007264074624435457
Round 98:
0.986052976720392 0.00697351163951887
Round 99:
0.9866108576516048 0.006694571173983643
Round 100:
0.987146423345562 0.0064267883270585635
Round 101:
0.9876605664117556 0.0061697167940019115
Round 102:
0.9881541437552974 0.00592292812226114
Round 103:
0.9886279780050945 0.0056860109973850825
Round 104:
0.9890828588848974 0.005458570557500431
Round 105:
0.9895195445295066 0.005240227735208602
Round 106:
0.9899387627483301 0.005030618625806338
Round 107:
0.9903412122383998 0.004829393880778632
Round 108:
0.990727563748866 0.004636218125550928
Round 109:
0.991098461198913 0.0044507694005315734
Round 110:
0.9914545227509577 0.004272738624512273
Round 111:
0.9917963418409202 0.004101829079533159
Round 112:
0.992124488167284 0.003937755916352814
Round 113:
0.9924395086405932 0.0037802456796994788
Round 114:
0.9927419282949699 0.0036290358525121746
Round 115:
0.9930322511631713 0.003483874418412025
Round 116:
0.9933109611166447 0.0033445194416760193
Round 117:
0.9935785226719791 0.0032107386640092273
Round 118:
0.9938353817651001 0.0030823091174491113
Round 119:
0.9940819664944962 0.0029590167527513422
Round 120:
0.9943186878347164 0.0028406560826413907
Round 121:
0.9945459403213278 0.002727029839335815
Round 122:
0.9947641027084747 0.002617948645762369
Round 123:
0.9949735386001358 0.002513230699932034
Round 124:
0.9951745970561304 0.0024127014719348416
Round 125:
0.9953676131738852 0.0023161934130574435
Round 126:
0.9955529086469298 0.0022235456765351547
Round 127:
0.9957307923010527 0.0021346038494738373
Round 128:
0.9959015606090105 0.002049219695494764
Round 129:
0.9960654981846501 0.001967250907675022
Round 130:
0.9962228782572641 0.0018885608713680169
Round 131:
0.9963739631269736 0.0018130184365133806
Round 132:
0.9965190046018947 0.0017404976990529342
Round 133:
0.9966582444178189 0.0016708777910907635
Round 134:
0.9967919146411062 0.0016040426794471374
Round 135:
0.9969202380554618 0.001539880972269092
Round 136:
0.9970434285332433 0.0014782857333783817
Round 137:
0.9971616913919136 0.0014191543040431576
Round 138:
0.997275223736237 0.0013623881318813869
Round 139:
0.9973842147867875 0.0013078926066061314
Round 140:
0.997488846195316 0.0012555769023419039
Round 141:
0.9975892923475034 0.0012053538262483121
Round 142:
0.9976857206536033 0.0011571396731984152
Round 143:
0.9977782918274591 0.0011108540862704297
Round 144:
0.9978671601543607 0.0010664199228195281
Round 145:
0.9979524737481863 0.0010237631259067959
Round 146:
0.9980343747982588 0.0009828126008705196
Round 147:
0.9981129998063285 0.0009435000968357476
Round 148:
0.9981884798140753 0.0009057600929622822
Round 149:
0.9982609406215124 0.0008695296892438087
Round 150:
0.9983305029966518 0.0008347485016739764
Round 151:
0.9983972828767858 0.0008013585616070129
Round 152:
0.9984613915617144 0.0007693042191427857
Round 153:
0.9985229358992458 0.0007385320503769943
Round 154:
0.998582018463276 0.0007089907683619501
Round 155:
0.998638737724745 0.0006806311376275076
Round 156:
0.9986931882157551 0.0006534058921223718
Round 157:
0.998745460687125 0.0006272696564375568
Round 158:
0.99879564225964 0.0006021788701801034
Round 159:
0.9988438165692544 0.0005780917153728193
Round 160:
0.9988900639064843 0.0005549680467580309
Round 161:
0.9989344613502249 0.0005327693248876608
Round 162:
0.9989770828962159 0.0005114585518921633
Round 163:
0.9990179995803673 0.0004910002098165167
w = -0.998527, b = 0.999018
"""